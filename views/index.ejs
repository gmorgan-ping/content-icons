<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/png" href="/public/images/flask.png">
  <title>
    <%= title %>
  </title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Material Icons -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Material+Icons+Outlined" rel="stylesheet">

  <!-- Material Design Icons (Pictogrammers) -->
  <link href="https://cdn.jsdelivr.net/npm/@mdi/font@7.4.47/css/materialdesignicons.min.css" rel="stylesheet">

  <!-- Custom CSS -->
  <link href="/public/styles.css" rel="stylesheet">

  <style>

  </style>
</head>

<body class="bg-light">
  <div class="container py-5">
    <div class="row justify-content-center">
      <div class="col-lg-10">
        <div class="d-flex justify-content-between align-items-start mb-5">
          <div class="text-center flex-grow-1">
            <h1 class="display-4 fw-bold text-dark mb-3">Marketplace Icons</h1>
            <p class="lead text-muted">Canonical set of default icons for Marketplace items</p>
          </div>
          <div>
            <a href="/logout" class="btn btn-outline-secondary btn-sm">
              <i class="material-icons-outlined me-1" style="vertical-align: middle; font-size: 16px;">logout</i>
              Sign Out
            </a>
          </div>
        </div>

        <div class="card shadow-sm">
          <div class="card-body p-4">
            <div class="row g-4">
              <% icons.forEach(function(iconData) { %>
                <div class="col-sm-6 col-md-4 col-lg-3">
                  <div class="flip-card" onclick="handleCardClick(this, event)">
                    <div class="flip-card-inner">
                      <!-- Front -->
                      <div class="flip-card-front text-center p-3 rounded bg-white border position-relative">
                        <% if (iconData.note) { %>
                          <div class="position-absolute info-icon" style="top: 8px; left: 8px; cursor: pointer;"
                            data-bs-toggle="tooltip" data-bs-placement="top" data-bs-html="true"
                            data-bs-title="Click to view notes" onclick="flipCardFromIcon(this, event)">
                            <i class="material-icons-outlined text-primary" style="font-size: 14px;">info</i>
                          </div>
                          <% } %>
                            <% if (iconData.status) { %>
                              <div class="position-absolute" style="top: 8px; right: 8px;">
                                <i class="material-icons-outlined text-success"
                                  style="font-size: 16px;">check_circle</i>
                              </div>
                              <% } %>
                                <h6 class="fw-semibold text-dark mb-3 text-center">
                                  <%= iconData.name %>
                                </h6>
                                <div class="mt-1 mb-3 px-3">
                                  <!-- Google Material Icon Row -->
                                  <div class="d-flex align-items-center gap-2 mb-2">
                                    <a href="https://fonts.google.com/icons?selected=Material+Icons+Outlined:<%= iconData.icon %>:FILL@0;wght@400;GRAD@0;opsz@24"
                                      target="_blank" rel="noopener noreferrer" class="text-decoration-none">
                                      <div
                                        class="position-relative rounded d-flex align-items-center justify-content-center p-2"
                                        style="height: 40px; width: 40px; background-color: <%= iconData.backgroundColor %>;"
                                        data-bs-toggle="tooltip" data-bs-placement="top" data-bs-html="true"
                                        data-bs-title="Click to view on Google Fonts:<br><%= iconData.icon %>">
                                        <i class="material-icons-outlined"
                                          style="font-size: 20px; color: <%= iconData.textColor %>;">
                                          <%= iconData.icon %>
                                        </i>
                                      </div>
                                    </a>
                                    <small class="text-muted">Google Material</small>
                                  </div>
                                  <!-- Pictogrammers MDI Row -->
                                  <div class="d-flex align-items-center gap-2">
                                    <a href="https://pictogrammers.com/library/mdi/icon/<%= iconData.iconClass.replace('mdi-', '') %>/"
                                      target="_blank" rel="noopener noreferrer" class="text-decoration-none">
                                      <div
                                        class="position-relative rounded d-flex align-items-center justify-content-center p-2"
                                        style="height: 40px; width: 40px; background-color: <%= iconData.backgroundColor %>;"
                                        data-bs-toggle="tooltip" data-bs-placement="top" data-bs-html="true"
                                        data-bs-title="Click to view on Pictogrammers:<br><%= iconData.iconClass %>">
                                        <i class="mdi <%= iconData.iconClass %>"
                                          style="font-size: 20px; color: <%= iconData.textColor %>;">
                                        </i>
                                      </div>
                                    </a>
                                    <small class="text-muted">Pictogrammers</small>
                                  </div>
                                </div>
                                <!-- <small class="text-muted d-block">Google Material: `<%= iconData.icon %>`</small>
                                <small class="text-muted d-block">MDI Class: `<%= iconData.iconClass %>`</small> -->
                                <div class="mt-2">
                                  <div class="d-flex flex-column gap-3">
                                    <span class="badge bg-light text-dark small">Color: <%= iconData.textColor %></span>
                                    <span class="badge bg-light text-dark small">Bg Color: <%= iconData.backgroundColor
                                        %>
                                    </span>
                                  </div>
                                </div>
                      </div>

                      <!-- Back -->
                      <div class="flip-card-back text-center p-2 rounded border"
                        style="background: linear-gradient(135deg, <%= iconData.backgroundColor %>, <%= iconData.textColor %>20);">
                        <div class="position-absolute" style="top: 16px; left: 50%; transform: translateX(-50%);">
                          <i class="material-icons-outlined" style="font-size: 32px; color: #666;">info</i>
                        </div>
                        <div class="position-absolute" style="top: 60px; left: 50%; transform: translateX(-50%);">
                          <h6 class="fw-bold text-dark mb-0">Notes</h6>
                        </div>
                        <div class="text-center" style="margin-top: 90px;">
                          <p class="small text-dark mb-0" style="line-height: 1.4;">
                            <% if (iconData.note) { %>
                              <%= iconData.note %>
                                <% } else { %>No notes available for this icon.<% } %>
                          </p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <% }); %>
            </div>

            <% if (icons.length===0) { %>
              <div class="text-center py-5">
                <div class="text-muted">
                  <i class="material-icons-outlined" style="font-size: 48px;">info</i>
                  <h5 class="mt-3">No icons configured</h5>
                  <p>Please check the configuration file to add icons.</p>
                </div>
              </div>
              <% } %>
          </div>
        </div>

        <div class="mt-4 text-center">
          <div class="mb-3">
            <div class="d-inline-flex align-items-center gap-2 px-3 py-2 bg-light rounded">
              <i class="material-icons-outlined text-success" style="font-size: 16px;">check_circle</i>
              <small class="text-dark fw-medium">Icons are correct</small>
            </div>
          </div>
          <small class="text-muted">
            Icons are loaded from <code>config/icons.json</code> configuration file
          </small>
          <div>
            <small class="text-muted">
              Engineering icons sourced from <a href="https://pictogrammers.com/library/mdi/" target="_blank"
                rel="noopener noreferrer">
                Material Icons
            </small>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    function flipCardFromIcon(iconElement, event) {
      event.stopPropagation();
      const card = iconElement.closest('.flip-card');

      // First, instantly flip back any other currently flipped cards without animation
      const allFlippedCards = document.querySelectorAll('.flip-card.flipped');
      allFlippedCards.forEach(flippedCard => {
        if (flippedCard !== card) {
          const inner = flippedCard.querySelector('.flip-card-inner');
          inner.style.transition = 'none';
          flippedCard.classList.remove('flipped');
          inner.offsetHeight; // Force reflow
          inner.style.transition = '';
        }
      });

      // Flip the card to show the back
      card.classList.add('flipped');
    }

    function handleCardClick(card, event) {
      // Only flip back if the card is currently flipped
      if (card.classList.contains('flipped')) {
        card.classList.remove('flipped');
      }
    }

    // Initialize Bootstrap tooltips with HTML enabled
    document.addEventListener('DOMContentLoaded', function () {
      const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
      const tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
        return new bootstrap.Tooltip(tooltipTriggerEl, {
          html: true
        });
      });
    });
  </script>
</body>

</html>